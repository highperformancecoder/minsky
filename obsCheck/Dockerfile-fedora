ARG version=36
FROM fedora:$version
ARG project=minsky
ARG version
ADD . /root
RUN dnf install -y 'dnf-command(config-manager)' util-linux

# handle dnf syntax change: here documents not working, so split Fedora 40 into separate Dockerfile
ARG repo=https://download.opensuse.org/repositories/home:/hpcoder1/Fedora_$version/home:hpcoder1.repo
RUN dnf config-manager addrepo --from-repofile=$repo
RUN dnf install -y $project
RUN useradd -m minsky
RUN su - minsky -c "minsky --version --no-sandbox"
RUN python3 -c "import pyminsky"
